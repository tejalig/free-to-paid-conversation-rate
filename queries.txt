
### Descriptive Analysis

# Count the total number of records in the each table - student_engagement, student_info, student_purchases
select count(*) from db_course_conversions.student_engagement;
select count(*) from db_course_conversions.student_info;
select count(*) from db_course_conversions.student_purchases;

student_engagement
- student_id
- date_watched

student_info
- student_id
- date_registered

student_purchases
- purchase_id
- student_id
- date_purchased

### Answering business questions

## Conversion Funnel Analysis

# Registration to Engagement: What percentage of students who register actually watch a video? - result : 50.70

SELECT 
    ROUND(COUNT(DISTINCT se.student_id) * 100.0 / COUNT(DISTINCT si.student_id), 2) AS Percent_Engaged
FROM student_info si
LEFT JOIN student_engagement se 
    ON si.student_id = se.student_id;


# Engagement to Purchase: What percentage of students who watched a video ended up buying the course?

SELECT 
    COUNT(DISTINCT sp.student_id) * 100.0 / COUNT(DISTINCT se.student_id) AS Percent_Engagement_to_Purchase
FROM student_engagement se
LEFT JOIN student_purchases sp 
    ON se.student_id = sp.student_id;


# Total Conversion: What percentage of all registered students became paid customers?

SELECT COUNT(DISTINCT sp.student_id)*100.0/COUNT(DISTINCT si.student_id) AS Percent_Registered_to_Purchase
FROM student_info si
LEFT JOIN student_purchases sp
    ON si.student_id = sp.student_id;


### Time-to-Event Analysis
# Onboarding Speed: How many days pass between registration and the first time they watch a video?

SELECT 
    si.student_id, 
    si.date_registered, 
    MIN(se.date_watched) AS first_date_watched, 
    DATEDIFF(MIN(se.date_watched), si.date_registered) AS days_to_onboard
FROM student_info si
INNER JOIN student_engagement se 
    ON si.student_id = se.student_id
GROUP BY si.student_id, si.date_registered;


# Conversion Lag: How many days does it take a student to purchase after their first engagement?
SELECT 
    se.student_id, 
    MIN(se.date_watched) AS first_engagement, 
    MIN(sp.date_purchased) AS purchase_date,
    DATEDIFF(MIN(sp.date_purchased), MIN(se.date_watched)) AS days_to_purchase
FROM student_engagement se
INNER JOIN student_purchases sp 
    ON se.student_id = sp.student_id
GROUP BY se.student_id;


